<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI ç»˜å›¾ç»ˆæç™¾ç§‘ V7.0 (å…¨é£æ ¼ä»‹è´¨ç‰ˆ)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        html {
            scroll-behavior: smooth;
            scroll-padding-top: 180px;
        }
        body {
            background-color: #FDFBF7;
            color: #333;
        }
        .hide-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .hide-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        .keyword-chip {
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            border: 1px solid #E5E7EB;
        }
        .keyword-chip:hover {
            transform: translateY(-2px);
            border-color: #Cfb898;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        .keyword-chip:active {
            transform: scale(0.98);
        }
        .nav-btn-active {
            background-color: #8B7355 !important;
            color: white !important;
            box-shadow: 0 4px 6px rgba(139, 115, 85, 0.3);
        }
        .chart-container {
            position: relative;
            height: 160px;
            width: 100%;
        }
        /* Fade in animation for grids */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        /* Modal styles */
        .glass-panel {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
        }
        .loader {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #8B7355;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="font-sans antialiased">

    <!-- 1. Header -->
    <header class="bg-white border-b border-gray-200 py-4">
        <div class="container mx-auto px-4 flex justify-between items-center">
            <div class="flex items-center gap-3">
                <div class="w-8 h-8 bg-[#8B7355] rounded-lg flex items-center justify-center text-white text-lg shadow-sm">ğŸ¨</div>
                <div>
                    <h1 class="text-lg font-bold text-gray-900 tracking-tight leading-none">Prompt Encyclopedia <span class="text-[#Cfb898] font-normal">V7.0</span></h1>
                    <p class="text-xs text-gray-500 mt-0.5">Gemini AI + ä»‹è´¨ä¸è®¾è®¡é£æ ¼</p>
                </div>
            </div>
            <div class="text-xs text-gray-400 font-mono hidden sm:block">Total Tokens: <span id="total-count" class="font-bold text-[#8B7355]">...</span></div>
        </div>
    </header>

    <!-- 2. Sticky Builder Bar -->
    <div id="builder-bar" class="sticky top-0 z-50 bg-[#FDFBF7]/95 backdrop-blur-sm border-b border-[#E5E0D8] shadow-sm transition-all duration-300">
        <div class="container mx-auto px-4 py-3">
            <div class="flex flex-col sm:flex-row gap-3 items-center">
                <div class="relative w-full group">
                    <div id="prompt-display" class="w-full min-h-[50px] max-h-[120px] overflow-y-auto py-2.5 px-3 bg-white rounded-lg border border-gray-300 text-gray-700 font-mono text-sm leading-6 break-words shadow-inner focus-within:ring-2 focus-within:ring-[#Cfb898] transition">
                        <span class="text-gray-400 italic select-none flex items-center h-full">ğŸ‘‡ ç‚¹å‡»ä¸‹æ–¹è¯æ±‡ï¼Œæˆ–ä½¿ç”¨ AI ç”Ÿæˆ...</span>
                    </div>
                </div>
                <div class="flex gap-2 w-full sm:w-auto shrink-0">
                    <button onclick="openAIModal()" class="flex-1 sm:flex-none px-4 py-2 rounded-lg text-sm font-bold text-white bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-700 hover:to-indigo-700 shadow-md hover:-translate-y-0.5 transition flex items-center justify-center gap-1">
                        âœ¨ AI çµæ„Ÿ
                    </button>
                    <button onclick="clearPrompts()" class="flex-1 sm:flex-none px-4 py-2 rounded-lg text-sm text-gray-600 hover:text-red-600 hover:bg-red-50 border border-transparent transition font-medium">æ¸…ç©º</button>
                    <button onclick="copyPrompts()" class="flex-1 sm:flex-none px-5 py-2 rounded-lg text-sm font-bold text-white bg-gray-900 hover:bg-black shadow-lg hover:-translate-y-0.5 transition flex items-center justify-center gap-2"><span>ğŸ“‹ å¤åˆ¶</span></button>
                </div>
            </div>
        </div>
        <!-- Mobile Nav -->
        <div class="lg:hidden border-t border-gray-200 bg-white overflow-x-auto hide-scrollbar">
            <div class="flex px-4 py-2 gap-2 min-w-max" id="mobile-nav-container"></div>
        </div>
    </div>

    <!-- 3. Main Content -->
    <main class="container mx-auto px-4 py-8 max-w-7xl">
        <div class="flex flex-col lg:flex-row gap-8 relative">
            
            <!-- Desktop Sidebar -->
            <aside class="hidden lg:block w-64 shrink-0 relative">
                <div class="sticky top-[140px] space-y-6">
                    <nav class="space-y-1 bg-white rounded-xl shadow-sm border border-gray-100 p-2" id="desktop-nav-container"></nav>
                    <div class="bg-white p-4 rounded-xl border border-gray-100 shadow-sm">
                        <h4 class="text-xs font-bold text-gray-400 uppercase tracking-wider mb-2 text-center">Prompt ç»“æ„å»ºè®®</h4>
                        <div class="chart-container"><canvas id="miniChart"></canvas></div>
                    </div>
                </div>
            </aside>

            <!-- Content Area -->
            <div class="flex-1 min-w-0" id="content-area">
                <div class="bg-white p-6 rounded-2xl border border-[#E5E0D8] shadow-sm mb-8">
                    <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4">
                        <div>
                            <div class="flex items-center gap-3 mb-1">
                                <span id="active-cat-icon" class="text-3xl">ğŸ’</span>
                                <h2 id="active-cat-title" class="text-2xl font-bold text-gray-800">ç”»è´¨ä¸æ¸…æ™°åº¦</h2>
                            </div>
                            <p id="active-cat-desc" class="text-gray-600 text-sm">...</p>
                        </div>
                        <div class="bg-[#F9F7F2] px-4 py-3 rounded-lg border border-[#EAE5D9] max-w-xs w-full md:w-auto">
                            <div class="flex items-center gap-2 mb-1">
                                <span class="w-1.5 h-1.5 rounded-full bg-[#Cfb898]"></span>
                                <span class="text-[#8B7355] text-xs font-bold uppercase">Pro Tip</span>
                            </div>
                            <p id="active-cat-tip" class="text-xs text-gray-600 leading-relaxed">...</p>
                        </div>
                    </div>
                </div>

                <div id="keywords-container" class="space-y-10"></div>
                <div class="h-20"></div>
            </div>
        </div>
    </main>

    <!-- AI Modal -->
    <div id="ai-modal" class="fixed inset-0 z-[100] hidden items-center justify-center bg-black/40 backdrop-blur-sm transition-opacity opacity-0">
        <div class="glass-panel w-full max-w-lg rounded-2xl shadow-2xl transform scale-95 transition-all duration-300 p-6 m-4 relative border border-white/50">
            <button onclick="closeAIModal()" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600 transition">âœ•</button>
            <div class="text-center mb-6">
                <div class="w-12 h-12 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-xl mx-auto flex items-center justify-center text-2xl shadow-lg mb-3">âœ¨</div>
                <h3 class="text-xl font-bold text-gray-800">AI çµæ„Ÿç”Ÿæˆå™¨</h3>
                <p class="text-sm text-gray-500">æè¿°ç”»é¢ï¼ŒAI å°†ä¸ºä½ ç¼–å†™å®Œç¾çš„å’’è¯­ã€‚</p>
            </div>
            <div class="space-y-4">
                <textarea id="ai-input" rows="3" class="w-full px-4 py-3 rounded-xl border border-gray-200 bg-white/50 focus:bg-white focus:ring-2 focus:ring-purple-500 outline-none resize-none text-sm" placeholder="ä¾‹å¦‚ï¼šä¸€å¼ å¤å¤CCDé£æ ¼çš„ç…§ç‰‡ï¼Œé—ªå…‰ç¯ç›´å°„ï¼Œå°‘å¥³åœ¨å¤œæ™šçš„è¡—é“æ¯”è€¶..."></textarea>
                <button onclick="generatePrompt()" id="ai-gen-btn" class="w-full py-3 rounded-xl bg-gradient-to-r from-indigo-600 to-purple-600 text-white font-bold shadow-md hover:shadow-lg transition flex items-center justify-center gap-2">
                    <span>ç”Ÿæˆå’’è¯­</span>
                    <div id="ai-loader" class="loader hidden"></div>
                </button>
                <div id="ai-result-container" class="hidden mt-4 pt-4 border-t border-gray-100">
                    <p class="text-xs text-gray-400 uppercase font-bold mb-2">ç”Ÿæˆç»“æœ:</p>
                    <div id="ai-output" class="p-3 bg-gray-50 rounded-lg border border-gray-200 text-sm font-mono text-gray-700 break-words mb-3"></div>
                    <button onclick="useGeneratedPrompt()" class="w-full py-2 rounded-lg bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium text-sm transition">ğŸ‘‡ ä½¿ç”¨æ­¤å’’è¯­</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Logic -->
    <script>
        // --- 7.0 DATA (Added 'art_styles' category) ---
        const promptData = {
            quality: {
                icon: "ğŸ’",
                title: "ç”»è´¨ (Quality)",
                desc: "å†³å®šç”»é¢çš„ç²¾ç»†åº¦ã€åˆ†è¾¨ç‡å’Œæ¸²æŸ“é£æ ¼ã€‚",
                tip: "SDXL è¯·å°è¯• 'Score_9'ï¼›MJ ä½¿ç”¨ '--style raw'ã€‚",
                keywords: [
                    { sub: "é€šç”¨æ ¸å¿ƒ", en: "Masterpiece", cn: "æ°ä½œ(æœ€é«˜æƒé‡)" },
                    { sub: "é€šç”¨æ ¸å¿ƒ", en: "Best quality", cn: "æœ€ä½³è´¨é‡" },
                    { sub: "é€šç”¨æ ¸å¿ƒ", en: "Authentic", cn: "çœŸå®çš„" },
                    { sub: "åˆ†è¾¨ç‡", en: "8k resolution", cn: "8Kè¶…æ¸…" },
                    { sub: "åˆ†è¾¨ç‡", en: "RAW photo", cn: "RAWåŸç‰‡" },
                    { sub: "åˆ†è¾¨ç‡", en: "UHD", cn: "è¶…é«˜æ¸…" },
                    { sub: "ç»†èŠ‚", en: "Hyper-detailed", cn: "è¶…ç»†èŠ‚" },
                    { sub: "ç»†èŠ‚", en: "Intricate details", cn: "é”™ç»¼ç»†èŠ‚" },
                    { sub: "ç»†èŠ‚", en: "Sharp focus", cn: "æ¸…æ™°èšç„¦" },
                    { sub: "æ¸²æŸ“", en: "Unreal Engine 5", cn: "è™šå¹»5å¼•æ“" },
                    { sub: "æ¸²æŸ“", en: "Ray tracing", cn: "å…‰çº¿è¿½è¸ª" },
                    { sub: "æè´¨", en: "Detailed texture", cn: "è¯¦ç»†çº¹ç†" },
                    { sub: "æè´¨", en: "Subsurface scattering", cn: "æ¬¡è¡¨é¢æ•£å°„" }
                ]
            },
            art_styles: {
                icon: "ğŸ¨",
                title: "ä»‹è´¨ä¸è®¾è®¡é£æ ¼ (Media)",
                desc: "æµ·æŠ¥ã€æ‚å¿—ã€CCDã€èƒ¶ç‰‡ä¸æ‹¼è´´é£æ ¼ã€‚å®šä¹‰ç”»é¢çš„â€œç‰©ç†ä»‹è´¨â€ã€‚",
                tip: "CCDé£æ ¼å¿…å¤‡ 'Flash photography'ï¼›æ‹¼å›¾é£æ ¼è¯·å°è¯• 'Grid view' æˆ– 'Photo booth'ã€‚",
                keywords: [
                    // Poster & Cover Styles
                    { sub: "æµ·æŠ¥ä¸å°é¢ (Poster)", en: "Movie poster", cn: "ç”µå½±æµ·æŠ¥" },
                    { sub: "æµ·æŠ¥ä¸å°é¢ (Poster)", en: "Hollywood style", cn: "å¥½è±åå¤§ç‰‡é£" },
                    { sub: "æµ·æŠ¥ä¸å°é¢ (Poster)", en: "Magazine cover", cn: "æ‚å¿—å°é¢" },
                    { sub: "æµ·æŠ¥ä¸å°é¢ (Poster)", en: "Vogue cover", cn: "Vogueé£" },
                    { sub: "æµ·æŠ¥ä¸å°é¢ (Poster)", en: "Fashion editorial", cn: "æ—¶å°šå¤§ç‰‡æ’ç‰ˆ" },
                    { sub: "æµ·æŠ¥ä¸å°é¢ (Poster)", en: "Album cover", cn: "ä¸“è¾‘/CDå°é¢" },
                    { sub: "æµ·æŠ¥ä¸å°é¢ (Poster)", en: "Vinyl record sleeve", cn: "é»‘èƒ¶å”±ç‰‡å°å¥—" },
                    { sub: "æµ·æŠ¥ä¸å°é¢ (Poster)", en: "Typography", cn: "æ–‡å­—æ’ç‰ˆè®¾è®¡" },
                    { sub: "æµ·æŠ¥ä¸å°é¢ (Poster)", en: "Minimalist poster", cn: "æç®€æµ·æŠ¥" },

                    // Retro Digital & CCD
                    { sub: "å¤å¤æ•°ç  (CCD/Retro)", en: "CCD sensor", cn: "CCDä¼ æ„Ÿå™¨è´¨æ„Ÿ" },
                    { sub: "å¤å¤æ•°ç  (CCD/Retro)", en: "Digital camera aesthetic", cn: "æ—©æœŸæ•°ç ç›¸æœºç¾å­¦" },
                    { sub: "å¤å¤æ•°ç  (CCD/Retro)", en: "Flash photography", cn: "é—ªå…‰ç¯ç›´å°„" },
                    { sub: "å¤å¤æ•°ç  (CCD/Retro)", en: "Harsh flash", cn: "å¼ºé—ªå…‰" },
                    { sub: "å¤å¤æ•°ç  (CCD/Retro)", en: "Low resolution", cn: "ä½åˆ†è¾¨ç‡(è‰ºæœ¯æ„Ÿ)" },
                    { sub: "å¤å¤æ•°ç  (CCD/Retro)", en: "Noise and grain", cn: "å™ªç‚¹ä¸é¢—ç²’" },
                    { sub: "å¤å¤æ•°ç  (CCD/Retro)", en: "Timestamp", cn: "æ—¶é—´æˆ³" },
                    { sub: "å¤å¤æ•°ç  (CCD/Retro)", en: "Webcore", cn: "æ—©æœŸç½‘ç»œé£æ ¼" },

                    // Collage & Grid (Updated with User Preference)
                    { sub: "æ‹¼å›¾ä¸æ’ç‰ˆ (Collage)", en: "Collage art", cn: "æ‹¼è´´è‰ºæœ¯" },
                    { sub: "æ‹¼å›¾ä¸æ’ç‰ˆ (Collage)", en: "Photo grid", cn: "å¤šå®«æ ¼æ‹¼å›¾" },
                    { sub: "æ‹¼å›¾ä¸æ’ç‰ˆ (Collage)", en: "Split screen", cn: "åˆ†å±" },
                    { sub: "æ‹¼å›¾ä¸æ’ç‰ˆ (Collage)", en: "Contact sheet", cn: "åº•ç‰‡å°æ ·(å¤šå›¾)" },
                    { sub: "æ‹¼å›¾ä¸æ’ç‰ˆ (Collage)", en: "Photo booth", cn: "å¤§å¤´è´´å››è¿æ‹" },
                    { sub: "æ‹¼å›¾ä¸æ’ç‰ˆ (Collage)", en: "Polaroid wall", cn: "æ‹ç«‹å¾—ç…§ç‰‡å¢™" },
                    { sub: "æ‹¼å›¾ä¸æ’ç‰ˆ (Collage)", en: "Film strip", cn: "èƒ¶å·æ¡" },
                    { sub: "æ‹¼å›¾ä¸æ’ç‰ˆ (Collage)", en: "Knolling", cn: "å¹³é“ºæ•´ç†(å¼ºè¿«ç—‡)" },
                    { sub: "æ‹¼å›¾ä¸æ’ç‰ˆ (Collage)", en: "Scrapbook style", cn: "å‰ªè´´ç°¿é£æ ¼" },
                    { sub: "æ‹¼å›¾ä¸æ’ç‰ˆ (Collage)", en: "Y2K Collage", cn: "Y2Kå¤å¤æ‹¼è´´" },

                    // Paper & Texture
                    { sub: "çº¸è´¨ä¸ä»‹è´¨ (Texture)", en: "Paper texture", cn: "çº¸å¼ çº¹ç†" },
                    { sub: "çº¸è´¨ä¸ä»‹è´¨ (Texture)", en: "Folded paper", cn: "æŠ˜ç—•çº¸" },
                    { sub: "çº¸è´¨ä¸ä»‹è´¨ (Texture)", en: "Crumpled paper", cn: "æ‰çš±çš„çº¸" },
                    { sub: "çº¸è´¨ä¸ä»‹è´¨ (Texture)", en: "Ripped paper", cn: "æ’•çº¸æ•ˆæœ" },
                    { sub: "çº¸è´¨ä¸ä»‹è´¨ (Texture)", en: "Sticker art", cn: "è´´çº¸è‰ºæœ¯" },
                    { sub: "çº¸è´¨ä¸ä»‹è´¨ (Texture)", en: "White outline", cn: "ç™½è¾¹/æè¾¹(è´´çº¸æ„Ÿ)" },
                    { sub: "çº¸è´¨ä¸ä»‹è´¨ (Texture)", en: "Vintage poster", cn: "å¤å¤æµ·æŠ¥" },
                    { sub: "çº¸è´¨ä¸ä»‹è´¨ (Texture)", en: "Halftone pattern", cn: "åŠè°ƒç½‘ç‚¹(æ¼«ç”»çº¸æ„Ÿ)" }
                ]
            },
            angles_vibe: {
                icon: "ğŸ¬",
                title: "è¿é•œä¸å¤§ç‰‡æ„Ÿ (Angles)",
                desc: "è½¦è¾†è§†è§’ã€åœºæ™¯æ„å›¾ä¸æ—¶å°šå¤§ç‰‡å§¿åŠ¿ã€‚",
                tip: "æ‹æ‘„è½¦æ—¶ï¼Œ'Low angle' æ˜¾éœ¸æ°”ï¼›æ‹äººæ—¶ï¼Œ'Dynamic pose' æ˜¾å¼ åŠ›ã€‚",
                keywords: [
                    { sub: "æ±½è½¦è§†è§’", en: "Front view", cn: "æ­£å‰è§†å›¾" },
                    { sub: "æ±½è½¦è§†è§’", en: "Side view", cn: "æ­£ä¾§è§†å›¾" },
                    { sub: "æ±½è½¦è§†è§’", en: "Rear view", cn: "æ­£åè§†å›¾" },
                    { sub: "æ±½è½¦è§†è§’", en: "3/4 view", cn: "45åº¦ä¾§è§†" },
                    { sub: "æ±½è½¦è§†è§’", en: "Top down view", cn: "é¡¶è§†/ä¸Šå¸è§†è§’" },
                    { sub: "æ±½è½¦è§†è§’", en: "Low angle", cn: "ä½è§’åº¦/ä»°è§†" },
                    { sub: "æ±½è½¦è§†è§’", en: "High angle", cn: "é«˜è§’åº¦/ä¿¯è§†" },
                    { sub: "æ±½è½¦è§†è§’", en: "Motion blur", cn: "åŠ¨æ€æ¨¡ç³Š" },
                    { sub: "è½¦å†…è§†è§’", en: "Car interior", cn: "è½¦å†…é¥°" },
                    { sub: "è½¦å†…è§†è§’", en: "Dashboard", cn: "ä»ªè¡¨ç›˜" },
                    { sub: "è½¦å†…è§†è§’", en: "Driver's POV", cn: "é©¾é©¶å‘˜è§†è§’" },
                    { sub: "æ—¶å°šå¤§ç‰‡", en: "High fashion pose", cn: "è¶…æ¨¡å§¿åŠ¿" },
                    { sub: "æ—¶å°šå¤§ç‰‡", en: "Vogue pose", cn: "Vogueå°é¢é£" },
                    { sub: "æ—¶å°šå¤§ç‰‡", en: "Walking towards camera", cn: "èµ°æ¥" },
                    { sub: "æ—¶å°šå¤§ç‰‡", en: "Looking over shoulder", cn: "å›çœ¸" },
                    { sub: "åœºæ™¯æ‘†æ‹", en: "Sitting on car hood", cn: "åå¼•æ“ç›–" },
                    { sub: "åœºæ™¯æ‘†æ‹", en: "Leaning on car", cn: "é è½¦è¾¹" },
                    { sub: "åœºæ™¯æ‘†æ‹", en: "Street snap", cn: "è¡—æ‹" }
                ]
            },
            emotions: {
                icon: "ğŸ˜²",
                title: "æƒ…ç»ªä¸è¡¨æƒ… (Emotions)",
                desc: "å¾®è¡¨æƒ…ä¸å¤¸å¼ é¢œè‰ºã€‚",
                tip: "å°è¯• 'Tearing up' æˆ– 'Disdain'ã€‚",
                keywords: [
                    { sub: "å¿«ä¹", en: "Smile", cn: "å¾®ç¬‘" },
                    { sub: "å¿«ä¹", en: "Grin", cn: "éœ²é½¿ç¬‘" },
                    { sub: "å¿«ä¹", en: "Laughing", cn: "å¤§ç¬‘" },
                    { sub: "å¿«ä¹", en: "Smirk", cn: "åç¬‘" },
                    { sub: "æ‚²ä¼¤", en: "Crying", cn: "å“­æ³£" },
                    { sub: "æ‚²ä¼¤", en: "Tearing up", cn: "çœ¼å«çƒ­æ³ª" },
                    { sub: "æ‚²ä¼¤", en: "Sad", cn: "æ‚²ä¼¤" },
                    { sub: "æ„¤æ€’", en: "Angry", cn: "ç”Ÿæ°”" },
                    { sub: "æ„¤æ€’", en: "Disdain", cn: "è”‘è§†" },
                    { sub: "å…¶ä»–", en: "Expressionless", cn: "æ— è¡¨æƒ…" },
                    { sub: "å…¶ä»–", en: "Blush", cn: "è„¸çº¢" },
                    { sub: "å…¶ä»–", en: "Seductive", cn: "è¯±æƒ‘" },
                    { sub: "å…¶ä»–", en: "Ahegao", cn: "é˜¿é»‘é¢œ" }
                ]
            },
            poses: {
                icon: "ğŸ’ƒ",
                title: "åŠ¨ä½œä¸å§¿åŠ¿ (Poses)",
                desc: "èº«ä½“è¯­è¨€ã€‚åŒ…å« Y2K é£æ ¼æ‰‹åŠ¿ã€‚",
                tip: "Y2K é£æ ¼å¿…å¤‡ 'Peace sign'ã€‚",
                keywords: [
                    { sub: "åŸºç¡€", en: "Standing", cn: "ç«™ç«‹" },
                    { sub: "åŸºç¡€", en: "Sitting", cn: "åç€" },
                    { sub: "åŸºç¡€", en: "Squatting", cn: "è¹²ä¸‹" },
                    { sub: "åŸºç¡€", en: "Kneeling", cn: "è·ªç€" },
                    { sub: "åŸºç¡€", en: "Lying", cn: "èººç€" },
                    { sub: "æ‰‹åŠ¿", en: "Peace sign", cn: "æ¯”è€¶" },
                    { sub: "æ‰‹åŠ¿", en: "Heart hands", cn: "æ¯”å¿ƒ" },
                    { sub: "æ‰‹åŠ¿", en: "Finger framing", cn: "æ‰‹æŒ‡ç›¸æ¡†" },
                    { sub: "æ‰‹åŠ¿", en: "Hand on face", cn: "æ‰‹æ‰˜è…®" },
                    { sub: "åŠ¨æ€", en: "Jumping", cn: "è·³è·ƒ" },
                    { sub: "åŠ¨æ€", en: "Running", cn: "å¥”è·‘" },
                    { sub: "åŠ¨æ€", en: "Dancing", cn: "è·³èˆ" },
                    { sub: "è§†è§’", en: "Looking back", cn: "å›çœ¸" },
                    { sub: "è§†è§’", en: "Selfie", cn: "è‡ªæ‹" }
                ]
            },
            animals: {
                icon: "ğŸ¾",
                title: "åŠ¨ç‰©ä¸å® ç‰© (Animals)",
                desc: "æ¯›å­©å­åŠ¨ä½œä¸è´¨æ„Ÿã€‚",
                tip: "åŠ ä¸Š 'Fluffy' å’Œ 'Paw pads'ã€‚",
                keywords: [
                    { sub: "ç§ç±»", en: "Cat", cn: "çŒ«" },
                    { sub: "ç§ç±»", en: "Dog", cn: "ç‹—" },
                    { sub: "ç§ç±»", en: "Kitten", cn: "å°çŒ«" },
                    { sub: "ç§ç±»", en: "Puppy", cn: "å°ç‹—" },
                    { sub: "ç‰¹å¾", en: "Fluffy", cn: "æ¯›èŒ¸èŒ¸" },
                    { sub: "ç‰¹å¾", en: "Paw pads", cn: "è‚‰å«" },
                    { sub: "ç‰¹å¾", en: "Wet nose", cn: "æ¹¿é¼»å­" },
                    { sub: "åŠ¨ä½œ", en: "Sleeping", cn: "ç¡è§‰" },
                    { sub: "åŠ¨ä½œ", en: "Stretching", cn: "ä¼¸æ‡’è…°" },
                    { sub: "åŠ¨ä½œ", en: "Rolling over", cn: "æ‰“æ»š" }
                ]
            },
            lighting: {
                icon: "ğŸ’¡",
                title: "å…‰å½± (Lighting)",
                desc: "å…‰çº¿å†³å®šæƒ…ç»ªã€‚",
                tip: "â€˜Volumetric lightingâ€™ å¢åŠ ç©ºé—´æ„Ÿã€‚",
                keywords: [
                    { sub: "è‡ªç„¶å…‰", en: "Golden hour", cn: "é»„é‡‘æ—¶åˆ»" },
                    { sub: "è‡ªç„¶å…‰", en: "Blue hour", cn: "è“è°ƒæ—¶åˆ»" },
                    { sub: "è‡ªç„¶å…‰", en: "Natural lighting", cn: "è‡ªç„¶å…‰" },
                    { sub: "è‰ºæœ¯å…‰", en: "Cinematic lighting", cn: "ç”µå½±å…‰æ•ˆ" },
                    { sub: "è‰ºæœ¯å…‰", en: "Volumetric lighting", cn: "ä½“ç§¯å…‰" },
                    { sub: "è‰ºæœ¯å…‰", en: "Rim lighting", cn: "è½®å»“å…‰" },
                    { sub: "åˆ›æ„å…‰", en: "Neon lighting", cn: "éœ“è™¹ç¯" },
                    { sub: "åˆ›æ„å…‰", en: "Bioluminescence", cn: "ç”Ÿç‰©è§å…‰" }
                ]
            },
            portrait: {
                icon: "ğŸ‘©",
                title: "äººåƒ (Portrait)",
                desc: "çš®è‚¤ä¸äº”å®˜ç»†èŠ‚ã€‚",
                tip: "â€˜Skin poresâ€™ æ˜¯çœŸå®çš„å„ç§ç»†èŠ‚ã€‚",
                keywords: [
                    { sub: "çš®è‚¤", en: "Detailed skin texture", cn: "çœŸå®çš®è‚¤" },
                    { sub: "çš®è‚¤", en: "Skin pores", cn: "æ¯›å­”" },
                    { sub: "çš®è‚¤", en: "Subsurface scattering", cn: "çš®è‚¤é€šé€" },
                    { sub: "çš®è‚¤", en: "Freckles", cn: "é›€æ–‘" },
                    { sub: "äº”å®˜", en: "Detailed eyes", cn: "ç»†èŠ‚çœ¼ç›" },
                    { sub: "äº”å®˜", en: "Glossy lips", cn: "å…‰æ³½å”‡" },
                    { sub: "äº”å®˜", en: "Makeup", cn: "åŒ–å¦†" },
                    { sub: "å‘å‹", en: "Messy hair", cn: "å‡Œä¹±å‘å‹" },
                    { sub: "å‘å‹", en: "Wet hair", cn: "æ¹¿å‘" }
                ]
            },
            style: {
                icon: "ğŸ–Œï¸",
                title: "è‰ºæœ¯æµæ´¾ (Art Styles)",
                desc: "ç»˜ç”»ä¸æ¸²æŸ“é£æ ¼ã€‚",
                tip: "åŒºåˆ† 'Digital' ä¸ 'Traditional'ã€‚",
                keywords: [
                    { sub: "Y2Kæ½®æµ", en: "Y2K aesthetic", cn: "åƒç¦§é£" },
                    { sub: "Y2Kæ½®æµ", en: "Holographic", cn: "å…¨æ¯é•­å°„" },
                    { sub: "æ•°å­—", en: "Cyberpunk", cn: "èµ›åšæœ‹å…‹" },
                    { sub: "æ•°å­—", en: "Anime", cn: "æ—¥ç³»åŠ¨æ¼«" },
                    { sub: "æ•°å­—", en: "3D render", cn: "3Dæ¸²æŸ“" },
                    { sub: "ä¼ ç»Ÿ", en: "Oil painting", cn: "æ²¹ç”»" },
                    { sub: "ä¼ ç»Ÿ", en: "Watercolor", cn: "æ°´å½©" },
                    { sub: "ä¼ ç»Ÿ", en: "Sketch", cn: "ç´ æ" }
                ]
            },
            camera: {
                icon: "ğŸ“·",
                title: "æ‘„å½± (Camera)",
                desc: "é•œå¤´ä¸å‚æ•°ã€‚",
                tip: "85mm æ‹äººåƒï¼ŒWide angle æ‹å¤§åœºæ™¯ã€‚",
                keywords: [
                    { sub: "é•œå¤´", en: "85mm lens", cn: "85mm(äººåƒ)" },
                    { sub: "é•œå¤´", en: "35mm lens", cn: "35mm(äººæ–‡)" },
                    { sub: "é•œå¤´", en: "Wide angle", cn: "å¹¿è§’" },
                    { sub: "é•œå¤´", en: "Macro photography", cn: "å¾®è·" },
                    { sub: "ç‰¹æ•ˆ", en: "Depth of field", cn: "æ™¯æ·±" },
                    { sub: "ç‰¹æ•ˆ", en: "Bokeh", cn: "è™šåŒ–" },
                    { sub: "ç‰¹æ•ˆ", en: "Motion blur", cn: "è¿åŠ¨æ¨¡ç³Š" },
                    { sub: "èƒ¶ç‰‡", en: "Kodak Portra 400", cn: "æŸ¯è¾¾èƒ¶ç‰‡" },
                    { sub: "èƒ¶ç‰‡", en: "Film grain", cn: "é¢—ç²’æ„Ÿ" },
                    { sub: "èƒ¶ç‰‡", en: "Polaroid", cn: "æ‹ç«‹å¾—" }
                ]
            },
            clothes: {
                icon: "ğŸ‘—",
                title: "æœé¥° (Clothes)",
                desc: "æè´¨ä¸å•å“ã€‚",
                tip: "æè¿°æè´¨ Texture å¾ˆé‡è¦ã€‚",
                keywords: [
                    { sub: "é¢æ–™", en: "Silk", cn: "ä¸ç»¸" },
                    { sub: "é¢æ–™", en: "Lace", cn: "è•¾ä¸" },
                    { sub: "é¢æ–™", en: "Latex", cn: "ä¹³èƒ¶" },
                    { sub: "é¢æ–™", en: "Leather", cn: "çš®é©" },
                    { sub: "ç‰¹æ®Š", en: "Translucent", cn: "åŠé€æ˜" },
                    { sub: "ç‰¹æ®Š", en: "Holographic fabric", cn: "é•­å°„é¢æ–™" },
                    { sub: "å•å“", en: "White shirt", cn: "ç™½è¡¬è¡«" },
                    { sub: "å•å“", en: "Dress", cn: "è¿è¡£è£™" }
                ]
            },
            env: {
                icon: "ğŸŒ",
                title: "ç¯å¢ƒ (Env)",
                desc: "åœºæ™¯ä¸æ„å›¾ã€‚",
                tip: "Dutch angle å¢åŠ åŠ¨æ„Ÿã€‚",
                keywords: [
                    { sub: "æ„å›¾", en: "Rule of thirds", cn: "ä¸‰åˆ†æ³•" },
                    { sub: "æ„å›¾", en: "Dutch angle", cn: "è·å…°è§’" },
                    { sub: "æ„å›¾", en: "Dynamic angle", cn: "åŠ¨æ€è§’åº¦" },
                    { sub: "åœºæ™¯", en: "Street", cn: "è¡—é“" },
                    { sub: "åœºæ™¯", en: "Nature", cn: "è‡ªç„¶" },
                    { sub: "åœºæ™¯", en: "Bedroom", cn: "å§å®¤" },
                    { sub: "åœºæ™¯", en: "Cyberpunk city", cn: "èµ›åšåŸå¸‚" },
                    { sub: "èƒŒæ™¯", en: "Simple background", cn: "ç®€å•èƒŒæ™¯" }
                ]
            },
            negative: {
                icon: "ğŸš«",
                title: "è´Ÿé¢ (Negative)",
                desc: "é€šç”¨è´Ÿé¢è¯ã€‚",
                tip: "Bad hands æ˜¯å¿…é¡»çš„ã€‚",
                keywords: [
                    { sub: "è´¨é‡", en: "Worst quality", cn: "æœ€å·®è´¨é‡" },
                    { sub: "è´¨é‡", en: "Low quality", cn: "ä½è´¨é‡" },
                    { sub: "è´¨é‡", en: "Lowres", cn: "ä½åˆ†è¾¨ç‡" },
                    { sub: "äººä½“", en: "Bad anatomy", cn: "ç»“æ„é”™è¯¯" },
                    { sub: "äººä½“", en: "Bad hands", cn: "åæ‰‹" },
                    { sub: "äººä½“", en: "Missing fingers", cn: "ç¼ºæ‰‹æŒ‡" },
                    { sub: "å…¶ä»–", en: "Watermark", cn: "æ°´å°" },
                    { sub: "å…¶ä»–", en: "Text", cn: "æ–‡å­—" }
                ]
            }
        };

        // State
        let currentCategory = 'quality';
        let selectedPrompts = [];
        let generatedPromptCache = "";

        // Elements
        const desktopNav = document.getElementById('desktop-nav-container');
        const mobileNav = document.getElementById('mobile-nav-container');
        const keywordsContainer = document.getElementById('keywords-container');
        const activeIcon = document.getElementById('active-cat-icon');
        const activeTitle = document.getElementById('active-cat-title');
        const activeDesc = document.getElementById('active-cat-desc');
        const activeTip = document.getElementById('active-cat-tip');
        const promptDisplay = document.getElementById('prompt-display');

        // Init
        function init() {
            renderNav();
            renderCategory('quality');
            initMiniChart();
            updateTotalCount();
        }

        function updateTotalCount() {
            let total = 0;
            Object.values(promptData).forEach(cat => total += cat.keywords.length);
            document.getElementById('total-count').innerText = total + '+';
        }

        // --- Nav Rendering ---
        function renderNav() {
            // Desktop
            desktopNav.innerHTML = '';
            Object.keys(promptData).forEach(key => {
                const cat = promptData[key];
                const isActive = key === currentCategory;
                const btn = document.createElement('button');
                btn.className = `w-full text-left px-4 py-3 rounded-lg flex items-center justify-between transition group ${
                    isActive ? 'nav-btn-active' : 'bg-transparent hover:bg-gray-50 text-gray-600'
                }`;
                btn.onclick = () => renderCategory(key);
                btn.innerHTML = `
                    <div class="flex items-center gap-3">
                        <span class="text-xl">${cat.icon}</span>
                        <span class="font-bold text-sm">${cat.title.split('(')[0]}</span>
                    </div>
                `;
                desktopNav.appendChild(btn);
            });

            // Mobile
            mobileNav.innerHTML = '';
            Object.keys(promptData).forEach(key => {
                const cat = promptData[key];
                const isActive = key === currentCategory;
                const btn = document.createElement('button');
                btn.className = `px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition border ${
                    isActive 
                    ? 'bg-[#8B7355] text-white border-[#8B7355] shadow-sm' 
                    : 'bg-white text-gray-600 border-gray-200 hover:border-[#Cfb898]'
                }`;
                btn.onclick = () => {
                    renderCategory(key);
                    btn.scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'center' });
                };
                btn.innerHTML = `${cat.icon} ${cat.title.split('(')[0]}`;
                mobileNav.appendChild(btn);
            });
        }

        // --- Content Rendering ---
        function renderCategory(key) {
            currentCategory = key;
            
            // Re-render navs for active state
            Array.from(desktopNav.children).forEach((btn, idx) => {
                const isMatch = Object.keys(promptData)[idx] === key;
                btn.className = `w-full text-left px-4 py-3 rounded-lg flex items-center justify-between transition group ${
                    isMatch ? 'nav-btn-active' : 'bg-transparent hover:bg-gray-50 text-gray-600'
                }`;
            });
            Array.from(mobileNav.children).forEach((btn, idx) => {
                const isMatch = Object.keys(promptData)[idx] === key;
                btn.className = `px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition border ${
                    isMatch 
                    ? 'bg-[#8B7355] text-white border-[#8B7355] shadow-sm' 
                    : 'bg-white text-gray-600 border-gray-200 hover:border-[#Cfb898]'
                }`;
            });

            const data = promptData[key];
            activeIcon.innerText = data.icon;
            activeTitle.innerText = data.title;
            activeDesc.innerText = data.desc;
            activeTip.innerText = data.tip;

            const grouped = {};
            data.keywords.forEach(item => {
                if (!grouped[item.sub]) grouped[item.sub] = [];
                grouped[item.sub].push(item);
            });

            keywordsContainer.innerHTML = '';
            Object.keys(grouped).forEach((subCat, index) => {
                const groupSection = document.createElement('div');
                groupSection.className = "bg-white p-5 rounded-xl border border-gray-100 shadow-sm transition hover:shadow-md";
                groupSection.style.animation = `fadeIn 0.3s ease-out ${index * 0.05}s forwards`;
                groupSection.style.opacity = '0';

                const headerDiv = document.createElement('div');
                headerDiv.className = "mb-4 pb-2 border-b border-gray-100 flex items-center";
                headerDiv.innerHTML = `<span class="text-xs font-bold text-[#8B7355] uppercase tracking-widest bg-[#FDFBF7] px-2 py-1 rounded">${subCat}</span>`;
                groupSection.appendChild(headerDiv);

                const grid = document.createElement('div');
                grid.className = "grid grid-cols-2 md:grid-cols-3 xl:grid-cols-4 gap-3";

                grouped[subCat].forEach(item => {
                    const chip = document.createElement('button');
                    chip.className = "keyword-chip w-full text-left bg-gray-50 p-2.5 rounded-lg group relative overflow-hidden";
                    chip.onclick = () => addToPrompt(item.en);
                    chip.innerHTML = `
                        <div class="font-bold text-gray-800 text-sm mb-0.5 pr-4 truncate">${item.en}</div>
                        <div class="text-xs text-gray-500 truncate">${item.cn}</div>
                        <div class="absolute top-1 right-1 w-2 h-2 rounded-full bg-[#Cfb898] opacity-0 group-hover:opacity-100 transition"></div>
                    `;
                    grid.appendChild(chip);
                });
                groupSection.appendChild(grid);
                keywordsContainer.appendChild(groupSection);
            });
        }

        // --- Builder Logic ---
        function addToPrompt(text) {
            if (!selectedPrompts.includes(text)) {
                selectedPrompts.push(text);
                updatePromptDisplay();
            } else {
                const chips = document.querySelectorAll('#prompt-display span');
                chips.forEach(chip => {
                    if (chip.innerText.includes(text)) {
                        chip.classList.add('ring-2', 'ring-red-400', 'bg-red-50');
                        setTimeout(() => chip.classList.remove('ring-2', 'ring-red-400', 'bg-red-50'), 400);
                    }
                });
            }
        }

        function updatePromptDisplay() {
            if (selectedPrompts.length === 0) {
                promptDisplay.innerHTML = '<span class="text-gray-400 italic select-none flex items-center h-full">ğŸ‘‡ ç‚¹å‡»ä¸‹æ–¹è¯æ±‡ï¼Œæˆ–ä½¿ç”¨ AI ç”Ÿæˆ...</span>';
                return;
            }
            promptDisplay.innerHTML = selectedPrompts.map((p, index) => `
                <span class="inline-flex items-center bg-white border border-gray-200 shadow-sm text-gray-800 px-2 py-1.5 rounded-md text-sm m-1 transition hover:border-red-300 group cursor-default">
                    ${p}
                    <button onclick="removePrompt(${index})" class="ml-2 text-gray-300 hover:text-red-500 focus:outline-none transition">Ã—</button>
                </span>
            `).join('');
            promptDisplay.scrollTop = promptDisplay.scrollHeight;
        }

        function removePrompt(index) {
            selectedPrompts.splice(index, 1);
            updatePromptDisplay();
        }

        function clearPrompts() {
            selectedPrompts = [];
            updatePromptDisplay();
        }

        function copyPrompts() {
            if (selectedPrompts.length === 0) return;
            const fullString = selectedPrompts.join(', ');
            navigator.clipboard.writeText(fullString).then(() => {
                const btn = document.querySelector('button[onclick="copyPrompts()"] span');
                const originalText = btn.innerText;
                btn.innerText = "âœ… å·²å¤åˆ¶!";
                setTimeout(() => btn.innerText = originalText, 2000);
            });
        }

        // --- AI Logic ---
        function openAIModal() {
            const modal = document.getElementById('ai-modal');
            const panel = modal.querySelector('.glass-panel');
            modal.classList.remove('hidden');
            void modal.offsetWidth;
            modal.classList.remove('opacity-0');
            panel.classList.remove('scale-95');
            panel.classList.add('scale-100');
            document.getElementById('ai-input').focus();
        }

        function closeAIModal() {
            const modal = document.getElementById('ai-modal');
            const panel = modal.querySelector('.glass-panel');
            modal.classList.add('opacity-0');
            panel.classList.remove('scale-100');
            panel.classList.add('scale-95');
            setTimeout(() => {
                modal.classList.add('hidden');
                document.getElementById('ai-result-container').classList.add('hidden');
                document.getElementById('ai-output').innerText = '';
                document.getElementById('ai-input').value = '';
                generatedPromptCache = "";
            }, 300);
        }

        async function generatePrompt() {
            const input = document.getElementById('ai-input').value.trim();
            if (!input) {
                alert("è¯·è¾“å…¥æè¿°æ–‡å­—");
                return;
            }
            const btnText = document.querySelector('#ai-gen-btn span');
            const loader = document.getElementById('ai-loader');
            const resultContainer = document.getElementById('ai-result-container');
            
            btnText.classList.add('hidden');
            loader.classList.remove('hidden');
            document.getElementById('ai-gen-btn').disabled = true;

            try {
                const apiKey = ""; // Runtime provided
                const prompt = `You are an expert AI art prompt engineer. Convert the user's input (often Chinese) into a comma-separated English prompt. Include quality tags. Input: "${input}"`;

                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] })
                });

                if (!response.ok) throw new Error('API failed');
                const data = await response.json();
                const aiText = data.candidates[0].content.parts[0].text.trim();

                generatedPromptCache = aiText;
                document.getElementById('ai-output').innerText = aiText;
                resultContainer.classList.remove('hidden');

            } catch (error) {
                console.error(error);
                alert("ç”Ÿæˆå¤±è´¥ï¼Œè¯·é‡è¯•ã€‚");
            } finally {
                btnText.classList.remove('hidden');
                loader.classList.add('hidden');
                document.getElementById('ai-gen-btn').disabled = false;
            }
        }

        function useGeneratedPrompt() {
            if (!generatedPromptCache) return;
            const parts = generatedPromptCache.split(',').map(s => s.trim()).filter(s => s.length > 0);
            parts.forEach(part => {
                if (!selectedPrompts.includes(part)) selectedPrompts.push(part);
            });
            updatePromptDisplay();
            closeAIModal();
            const bar = document.getElementById('builder-bar');
            bar.classList.add('bg-purple-100');
            setTimeout(() => bar.classList.remove('bg-purple-100'), 500);
        }

        // --- Chart ---
        function initMiniChart() {
            const ctx = document.getElementById('miniChart').getContext('2d');
            new Chart(ctx, {
                type: 'polarArea',
                data: {
                    labels: ['Quality', 'Emotion', 'Pose', 'Media', 'Light'],
                    datasets: [{
                        data: [10, 8, 8, 9, 8],
                        backgroundColor: [
                            'rgba(139, 115, 85, 0.7)',
                            'rgba(207, 184, 152, 0.7)',
                            'rgba(74, 74, 74, 0.7)',
                            'rgba(212, 196, 183, 0.7)',
                            'rgba(229, 224, 216, 0.7)'
                        ],
                        borderWidth: 1,
                        borderColor: '#fff'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: { r: { ticks: { display: false }, grid: { display: false } } },
                    plugins: { legend: { display: false } }
                }
            });
        }
        window.onclick = function(event) {
            if (event.target == document.getElementById('ai-modal')) closeAIModal();
        }

        window.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
